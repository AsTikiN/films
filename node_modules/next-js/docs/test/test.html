<!DOCTYPE html>
<html>
  <head>
    <title>Next JS</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js"></script>
    <style>
      body {
        font: 16px/1.6 "Helvetica Neue", arial, sans-serif;
        padding: 60px;
      }
      pre { font-size: 14px; line-height: 1.3 }
      code .init { color: #2F6FAD }
      code .string { color: #5890AD }
      code .keyword { color: #8A6343 }
      code .number { color: #2F6FAD }
    </style>
    <script>
      $(function(){
        $('code').each(function(){
          $(this).html(highlight($(this).text()));
        });
      });

      function highlight(js) {
        return js
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;')
          .replace(/\/\/(.*)/gm, '<span class="comment">//$1</span>')
          .replace(/('.*')/gm, '<span class="string">$1</span>')
          .replace(/(\d+\.\d+)/gm, '<span class="number">$1</span>')
          .replace(/(\d+)/gm, '<span class="number">$1</span>')
          .replace(/\bnew *(\w+)/gm, '<span class="keyword">new</span> <span class="init">$1</span>')
          .replace(/\b(function|new|throw|return|var|if|else)\b/gm, '<span class="keyword">$1</span>')
      }
    </script>
  </head>
  <body>
    <h1>Next JS</h1>
    <p>The Next JS test suite.</p>
    <section class="suite">
      <h1>NX.apply</h1>
      <dl>
        <dt>空のオブジェクトに値が適用されること</dt>
        <dd><pre><code>

        var src = {}, ret;

        ret = NX.apply(src, {
            foo: 'bar'
        });

        src.should.equal(ret);
        src.foo.should.equal('bar');</code></pre></dd>
        <dt>デフォルト値が適用されること</dt>
        <dd><pre><code>

        var src = {}, config, defaults, ret;

        config = {
            foo: 'bar'
        };

        defaults = {
            foo     : 'default value',
            hoge    : 'piyo'
        };

        ret = NX.apply(src, config, defaults);

        src.should.equal(ret);
        src.foo.should.equal('bar');
        src.hoge.should.equal('piyo');</code></pre></dd>
      </dl>
    </section>
    <section class="suite">
      <h1>NX.applyIf</h1>
      <dl>
        <dt>未定義のキーに新たなキーを追加することができること</dt>
        <dd><pre><code>

        var src, ret;

        src = {
            hoge: 'piyo'
        };

        ret = NX.applyIf(src, {
            foo: 'bar'
        });

        src.should.equal(ret);
        src.foo.should.equal('bar');
        src.hoge.should.equal('piyo');</code></pre></dd>
        <dt>既に定義されているキーが上書きされないこと</dt>
        <dd><pre><code>

        var src, config, ret;

        src = {
            foo: 'original'
        };

        config = {
            foo: 'bar'
        };

        ret = NX.applyIf(src, config);

        src.should.equal(ret);
        src.foo.should.equal('original');</code></pre></dd>
      </dl>
    </section>
    <section class="suite">
      <h1>NX.clone</h1>
      <dl>
        <dt>オブジェクト型のクローンを生成し、値を変更してオリジナルに影響がないこと</dt>
        <dd><pre><code>

        var o, c;

        o = {
            src: 'src object'
        };

        c = NX.clone(o);

        o.src.should.equal('src object');
        c.src.should.equal('src object');

        o.src = 'changed';

        o.src.should.equal('changed');
        c.src.should.equal('src object');</code></pre></dd>
        <dt>関数型のクローンを生成し、値を変更してオリジナルに影響がないこと</dt>
        <dd><pre><code>

        var o, c;

        o = function() {
            return 'original';
        };

        c = NX.clone(o);

        o().should.equal('original');
        c().should.equal('original');

        o = function() {
            return 'replace';
        }

        o().should.equal('replace');
        c().should.equal('original');</code></pre></dd>
        <dt>日付型のクローンを生成し、値を変更してオリジナルに影響がないこと</dt>
        <dd><pre><code>

        var dt, dt2;

        dt = new Date();
        dt2 = NX.clone(dt);

        dt.getMilliseconds().should.equal(dt2.getMilliseconds());
        dt2.setMilliseconds(500);
        dt.getMilliseconds().should.not.equal(dt2.getMilliseconds());</code></pre></dd>
        <dt>配列のクローンを生成し、値を変更してオリジナルに影響がないこと</dt>
        <dd><pre><code>

        var o, c;

        o = function() {
            return 'original';
        };

        c = NX.clone(o);

        o().should.equal('original');
        c().should.equal('original');

        o = function() {
            return 'replace';
        }

        o().should.equal('replace');
        c().should.equal('original');</code></pre></dd>
        <dt>オブジェクト内に配列を持つオブジェクトのクローンを生成し、値を変更してオリジナルに影響がないこと</dt>
        <dd><pre><code>

        var o, c;

        o = {
            cn: [{
                tag: 'a'
            },{
                tag: 'span'
            }]
        };
        o.obj = o.cn;

        c = NX.clone(o);

        o.cn[0].tag.should.equal('a');
        o.cn[1].tag.should.equal('span');

        c.cn[0].tag.should.equal('a');
        c.cn[1].tag.should.equal('span');

        o.obj[0].tag.should.equal('a');
        o.obj[1].tag.should.equal('span');

        c.obj[0].tag.should.equal('a');
        c.obj[1].tag.should.equal('span');

        c.cn.push({tag: 'div'});

        o.cn.length.should.equal(2);
        c.cn.length.should.equal(3);

        o.obj.length.should.equal(2);
        c.obj.length.should.equal(2);</code></pre></dd>
        <dt>引数に指定する値が、undefined,null,空文字列の場合、引数に指定されたものと同一のものを返却する</dt>
        <dd><pre><code>

        require('assert').equal(NX.clone(), undefined);
        require('assert').equal(NX.clone(null), null);
        NX.clone('').should.equal('');</code></pre></dd>
      </dl>
    </section>
  </body>
</html>
